{% extends "base.html" %}

{% block scripts %}
<script type="text/javascript">
function modifyAbstract(id) {
    window.location = '/account/abstracts/modify/' + id;
}

function deleteAbstract(id) {
    if (confirm("Do your really want do delete this abstract?") === true) {
        window.location = '/account/abstracts/delete/' + id;
    }
}

function getTex(id) {
    window.location = '/account/abstracts/tex/' + id;
}

function getPdf(id) {
    window.location = '/account/abstracts/pdf/' + id;
}

function getLog(id) {
    window.location = '/account/abstracts/log/' + id;
}
</script>
{% endblock %}

{% block content %}
    <h2>My Abstracts</h2>

    {% if message %}
        <div class="note error">
            <b>ERROR:</b> {{ message }}
        </div>
    {% endif %}

    {% if not abstracts %}
        <div id="abstracts-box">You didn't submit any abstracts yet.</div>
    {% else %}
        <div id="abstracts">
            <table>
                <tbody>
                    {% for abstract in abstracts %}
                        <tr>
                            <th>ID:</th>
                            <td>{{ abstract.id }}</td>
                        </tr>
                        <tr>
                            <th>Title:</th>
                            <td>{{ abstract.to_cls.title|escape }}</td>
                        </tr>
                        <tr>
                            <th>Compilation:</th>
                            <td>{{ abstract.compiled|yesno:"Success (compilation succeeded),Failure (see log for details),Pending (compilation in progress)" }}</td>
                        </tr>
                        <tr>
                            <th>Format Check:</th>
                            <td>{{ abstract.verified|yesno:"Success (your abstract is ready for final review),Failure (problems with your template were discovered),Pending (your abstract wasn't checked yet)" }}</td>
                        </tr>
                        <tr>
                            <th>Review Status:</th>
                            <td>{{ abstract.accepted|yesno:"Accepted (your abstract was accepted for the conference),Not Accepted (your abstract wasn't accepted for the conference),Pending (your abstract wasn't reviewed yet)" }}</td>
                        </tr>
                        <tr>
                            <th>Submitted:</th>
                            <td>{{ abstract.submit_date }}</td>
                        </tr>
                        {% ifnotequal abstract.submit_date abstract.modify_date %}
                            <tr>
                                <th>Last Modified:</th>
                                <td>{{ abstract.modify_date }}</td>
                            </tr>
                        {% endifnotequal %}
                        <tr>
                            <th></th>
                            <td>
                                <button class="button" onclick="modifyAbstract('{{ abstract.id }}')"
                                    {% if abstract.accepted != None %} disabled="disabled" {% endif %}>Modify</button>
                                <button class="button" onclick="deleteAbstract('{{ abstract.id }}')"
                                    {% if abstract.accepted != None %} disabled="disabled" {% endif %}>Delete</button>
                                <button class="button" onclick="getTex('{{ abstract.id }}')">TeX</button>
                                <button class="button" onclick="getPdf('{{ abstract.id }}')">PDF</button>
                                <button class="button" onclick="getLog('{{ abstract.id }}')">Log</button>
                            </td>
                        </tr>
                        {% if not forloop.last %}
                            <tr><th class="bar" /><td class="bar" /></tr>
                        {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
    <button class="button" onclick="window.location='/account/abstracts/submit/'">Submit Abstract</button>
{% endblock %}
